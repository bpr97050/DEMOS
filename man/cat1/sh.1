
SH(1)                  ДЕМОС. Команды                  SH(1)


ИИММЯЯ
       sshh - командный язык.

ФФООРРММААТТ
       sshh [--cceeiikknnrrssttuuvvxx] [_п_а_р_а_м_е_т_р_ы...]

ООППИИССААННИИЕЕ
       Команда sshh вызывает  интерпретатор  командного  языка
       sshheellll, который является основным языком общения поль-
       зователя с системой. Кроме того, sshheellll широко  приме-
       няется и в качестве языка разработки программ.

ККООММААННДДЫЫ
       Простая команда представляет собой последовательность
       слов,  разделенных  пробелами,  знаками табуляции или
       символами новой строки. Первое слово  определяет  имя
       команды,  которая  должна  быть  выполнена. Остальные
       слова передаются  в  качестве  параметров  вызываемой
       команды. Имя команды является нулевым параметром (см.
       _e_x_e_c(2)).  "Значением" простой  команды  является  ее
       код  завершения,  если  она  выполнена  успешно,  или
       200+код - в противном случае (список кодов завершения
       приведен в разделе _s_i_g_n_a_l(2)).

       Несколько команд, разделенных символом '|', представ-
       ляют  собой  канал  межпроцессной  связи. Информация,
       выдаваемая в стандартный файл вывода одной  командой,
       может  передаваться  другой  команде в качестве стан-
       дартного файла ввода. При этом создается цепочка про-
       цессов  -  конвейер.   Каждая команда выполняется как
       отдельный процесс; sshh ждет окончания трансляции  пос-
       ледней из выполняемых команд.

       _С_п_и_с_о_к__к_о_м_а_н_д представляет  собой  последовательность
       из  одной  или нескольких простых команд, разделенных
       символами ';', '&', '&&' или '||', и  может  заканчи-
       ваться  символами  ';'  или  '&'.  Символы ';', '&' и
       '&&',  '||'  попарно  имеют   одинаковый   приоритет,
       однако,  приоритет  пары '&' и '|' ниже, чем у '&&' и
       '||'.    Точка   с   запятой,   стоящая    в    конце
       _с_п_и_с_к_а__к_о_м_а_н_д,  вызывает  последовательное выполнение
       указанных команд; амперсенд ('&')  указывает  на  то,
       что следующая команда может быть выполнена без ожида-
       ния завершения предыдущей (фоновый  процесс).  Символ
       '&&'  ('||') разрешает выполнение последующей команды
       только в том случае, если код  завершения  предыдущей
       равен  нулю (не равен нулю).  В качестве разделителей
       в списках команд вместо точки с запятой могут исполь-
       зоваться символы новой строки.

       Код  завершения  _с_п_и_с_к_а__к_о_м_а_н_д  равен  значению  кода
       завершения последней простой команды списка.

       Последовательность команд можно  записать  в  файл  и
       выполнить,  указав имя этого файла. Далее перечислены
       основные конструкции командного языка sshh.




                            -1-                     ДЕМОС/PV


SH(1)                  ДЕМОС. Команды                  SH(1)


       ffoorr _и_м_я [iinn _с_л_о_в_о ...]
       ddoo _с_п_и_с_о_к__к_о_м_а_н_д
       ddoonnee

              При каждом повторении цикла ffoorr _и_м_я устанавли-
              вается  на  следующее  значение в списке _с_л_о_в_о
              .... Если конструкция iinn  _с_л_о_в_о  ...  отсутст-
              вует,  то  по  умолчанию  предполагается iinn $@
              (т.е. цикл выполняется один  раз  для  каждого
              заданного параметра).

       ccaassee _с_л_о_в_о iinn
             _о_б_р_1 [|_о_б_р_2]...) _с_п_и_с_о_к__к_о_м_а_н_д;;
             ...
       eessaacc

              При обнаружении соответствия _с_л_о_в_а  одному  из
              образцов,  выполняется заданный _с_п_и_с_о_к__к_о_м_а_н_д.
              Образец '*' соответствует любой строке.

        iiff _с_п_и_с_о_к__к_о_м_а_н_д_1
        tthheenn _с_п_и_с_о_к__к_о_м_а_н_д_2
       [eellssee iiff _с_п_и_с_о_к__к_о_м_а_н_д_3 tthheenn _с_п_и_с_о_к__к_о_м_а_н_д_4]
       [eellssee _с_п_и_с_о_к__к_о_м_а_н_д_5]
        ffii

              Если код завершения _с_п_и_с_к_а__к_о_м_а_н_д_1 равен нулю,
              выполняется     _с_п_и_с_о_к__к_о_м_а_н_д_2,     иначе    -
              _с_п_и_с_о_к__к_о_м_а_н_д_3" и,  если  его  код  завершения
              равен нулю, выполняется _с_п_и_с_о_к__к_о_м_а_н_д_4. В про-
              тивном случае выполняется _с_п_и_с_о_к__к_о_м_а_н_д_5.

        wwhhiillee _с_п_и_с_о_к__к_о_м_а_н_д_1
       [ddoo _с_п_и_с_о_к__к_о_м_а_н_д_2]
        ddoonnee

              Если код завершения _с_п_и_с_к_а__к_о_м_а_н_д_1 равен нулю,
              выполняется _с_п_и_с_о_к__к_о_м_а_н_д_2 и цикл повторяется,
              иначе - выполнение цикла заканчивается.

        uunnttiill _с_п_и_с_о_к__к_о_м_а_н_д_1
       [ddoo _с_п_и_с_о_к__к_о_м_а_н_д_2]
        ddoonnee

              Если код завершения  _с_п_и_с_к_а__к_о_м_а_н_д_1  не  равен
              нулю, выполняется _с_п_и_с_о_к__к_о_м_а_н_д_2 и цикл повто-
              ряется, иначе -  выполнение  цикла  заканчива-
              ется.

       (_с_п_и_с_о_к__к_о_м_а_н_д)
              Выполнить   _с_п_и_с_о_к__к_о_м_а_н_д,   запустив   sshh   в
              качестве подпроцесса.

       {_с_п_и_с_о_к__к_о_м_а_н_д;}
              Просто выполнить _с_п_и_с_о_к__к_о_м_а_н_д.

       К зарезервированным словам  интерпретатора  sshh  отно-
       сятся  следующие  слова:  iiff,  tthheenn,  eellssee, eelliiff, ffii,


                            -2-                     ДЕМОС/PV


SH(1)                  ДЕМОС. Команды                  SH(1)


       ccaassee, iinn, eessaacc, ffoorr, wwhhiillee,  uunnttiill,  ddoo,  ddoonnee,  '{',
       '}'.   Они  распознаются  только  в  том случае, если
       являются первым  словом  команды  и  не  заключены  в
       кавычки.

ППООДДССТТААННООВВККАА РРЕЕЗЗУУЛЛЬЬТТААТТООВВ ВВЫЫППООЛЛННЕЕННИИЯЯ ККООММААННДД
       Если команда заключена в обратные апострофы (``), она
       выполняется и замещается в командной строке результа-
       том своего выполнения. Этот результат может использо-
       ваться  как  часть слова или как целое слово; символы
       новой строки отбрасываются.

ППООДДССТТААННООВВККАА ЗЗННААЧЧЕЕННИИЙЙ ППААРРААММЕЕТТРРООВВ
       Символ '$' указывает на выполнение подстановки значе-
       ний  параметров.  Команда  set  присваивает  значения
       позиционным  параметрам.  Переменные  устанавливаются
       следующим образом:

                  _и_м_я=_з_н_а_ч_е_н_и_е [_и_м_я=_з_н_а_ч_е_н_и_е] ...

       ${_п_а_р_а_м_е_т_р}
              _П_а_р_а_м_е_т_р может быть трех видов:

              1) последовательность букв, цифр или  символов
              подчеркивания  (т.е.  определенное _и_м_я), такие
              параметры также называются макропеременными,

              2) цифра (позиционный параметр вызова sshh),

              3) один из символов * @ # ? - $ !.

              В результате  выполнения  данного  макровызова
              осуществляется  подстановка значения параметра
              (если  оно   определено).    Фигурные   скобки
              используются  только  в том случае, если после
              _п_а_р_а_м_е_т_р_а следует буква, цифра или символ под-
              черкивания,  не  являющиеся  частью его имени.
              Если _п_а_р_а_м_е_т_р_о_м является символ * или @, подс-
              тавляются значения всех позиционных параметров
              (кроме 00), разделенные пробелами.

       ${_п_а_р_а_м_е_т_р-_с_л_о_в_о}
              Если _п_а_р_а_м_е_т_р определен, подставить его значе-
              ние, иначе подставить _с_л_о_в_о.

       ${_п_а_р_а_м_е_т_р=_с_л_о_в_о}
              Если _п_а_р_а_м_е_т_р не определен, присвоить ему зна-
              чение _с_л_о_в_а и выполнить подстановку этого зна-
              чения. Значения позиционных  параметров  таким
              способом определяться не могут.

       ${_п_а_р_а_м_е_т_р?_с_л_о_в_о}
              Если _п_а_р_а_м_е_т_р определен, подставить его значе-
              ние;   иначе  напечатать  _с_л_о_в_о  и  прекратить
              выполнение  командного   файла.   Если   _с_л_о_в_о
              отсутствует, печатается стандартное диагности-
              ческое сообщение.



                            -3-                     ДЕМОС/PV


SH(1)                  ДЕМОС. Команды                  SH(1)


       ${_п_а_р_а_м_е_т_р+_с_л_о_в_о}
              Если _п_а_р_а_м_е_т_р определен, подставить  _с_л_о_в_о,  в
              противном случае ничего не подставлять.

       В приведенных выше конструкциях команда, определяемая
       _с_л_о_в_о_м,  не будет выполняться, если _с_л_о_в_о не является
       подставляемым значением.  (Таким образом,  в  примере
       "eecchhoo $${{_d--``ppwwdd``}}"   команда   ppwwdd  будет  выполняться
       только в том случае если параметр _d не определен).

       Следующие   _п_а_р_а_м_е_т_р_ы   автоматически    определяются
       интерпретатором sshh:

       ##      Количество позиционных параметров.

       --      Ключи,  которые  вводятся  при  вызове  или  с
              помощью команды sseett.

       ??      Код завершения последней выполненной команды.

       $$      Номер текущего процесса.

       !!      Номер процесса последней фоновой команды.

       Следующие _п_а_р_а_м_е_т_р_ы используются, но не  определяются
       интерпретатором sshh:

       HHOOMMEE   Параметр  содержит  полное  имя  каталога  (по
              умолчанию - имя регистрационного каталога) для
              команды ccdd, вызываемой без параметров.

       PPAATTHH   Список имен каталогов, в которых  производится
              поиск команд, отсутствующих в текущем каталоге
              (см. "Выполнение").

       MMAAIILL   Если эта переменная определяет имя  файла  для
              приема  почты, то sshh будет информировать поль-
              зователя о поступлении почты в указанный файл.

       PPSS11    Подсказка интерпретатора при вводе команды, по
              умолчанию '$'.

       PPSS22    Подсказка интерпретатора для продолжения ввода
              (если  команда не была завершена на предыдущей
              строке), по умолчанию '>'.

       IIFFSS    Символы-разделители командной  строки;  обычно
              пробел, знак табуляции и символ новой строки.

ИИННТТЕЕРРППРРЕЕТТААЦЦИИЯЯ РРААЗЗДДЕЕЛЛИИТТЕЕЛЛЕЕЙЙ
       В  строках,  полученных  после  подстановки  значений
       параметров и результатов выполнения команд, осуществ-
       ляется поиск  символов-разделителей  (определенных  в
       $IIFFSS).   В  местах  нахождения  таких символов строки
       разбиваются на отдельные параметры. Пустые параметры,
       определенные  явно (" " или ' '), сохраняются. Пустые
       строки, полученные в результате  выполнения  парамет-
       ров, у которых нет значений, отбрасываются.


                            -4-                     ДЕМОС/PV


SH(1)                  ДЕМОС. Команды                  SH(1)


ГГЕЕННЕЕРРААЦЦИИЯЯ ИИММЕЕНН ФФААЙЙЛЛООВВ
       После   подстановок   и    интерпретации    символов-
       разделителей  в  каждом  слове команды осуществляется
       поиск символов *, ?, и [. Если  встречается  один  из
       этих  символов,  то данное слово считается образцом и
       заменяется соответствующим списком имен файлов,  рас-
       положенных  в  алфавитном  порядке.   Если образцу не
       соответствует ни одно из указанных  имен  файлов,  то
       это  слово  остается неизменным.  Символ "." в начале
       имени файла должен указываться явно.

       *      Соответствует любой строке, в том  числе  пус-
              той.

       ?      Соответствует любому одиночному символу.

       [...]  Соответствует любому из  перечисленных  симво-
              лов.  Пара символов, разделенная символом '-',
              соответствует  любому  символу  из  указанного
              лексического промежутка.

ЭЭККРРААННИИРРООВВААННИИЕЕ
       Следующие  символы  имеют  специальное  значение  для
       интерпретатора  sshh  и  вызывают прерывание выполнения
       команды, если они не  были  экранированы:  ';',  '&',
       '(',  ')', '|', '<', '>', _н_о_в_а_я__с_т_р_о_к_а, _п_р_о_б_е_л, _т_а_б_у_-
       _л_я_ц_и_я.

       Символ может быть экранирован, если ему  предшествует
       \.   Для записи длинных конструкций более чем в одной
       строке, специальное  значение  символа  новой  строки
       '\n'  отменяется.   Все символы, заключенные в апост-
       рофы (' '), за исключением самого апострофа, являются
       экранированными.   Подстановка  значений параметров и
       результатов  выполнения  команд  выполняется   внутри
       кавычек  (" "). Символ \ экранирует символы \, `, " и
       $. Таким образом:

       "$*" эквивалентно "$1 $2 ..."
       "$@" эквивалентно "$1" "$2" ... .

ППООДДССККААЗЗККИИ
       В интерактивном режиме перед считыванием  команды  sshh
       печатает  значение переменной PPSS11 (по умолчанию - $).
       Если введенная строка содержит синтаксически незавер-
       шенную  конструкцию, то для продолжения ввода интерп-
       ретатор выдает в качестве подсказки значение перемен-
       ной PPSS22 (по умолчанию - символ >).

ВВВВООДД--ВВЫЫВВООДД
       Для задания файлов ввода/вывода  используются  специ-
       альные  конструкции.  Они  могут  находиться  в любом
       месте простой команды. Перед использованием _с_л_о_в_а или
       _ц_и_ф_р_ы выполняются все необходимые подстановки.

       <_с_л_о_в_о Файл  _с_л_о_в_о  назначается  стандартным   файлом
              ввода (дескриптор файла 0).



                            -5-                     ДЕМОС/PV


SH(1)                  ДЕМОС. Команды                  SH(1)


       >_с_л_о_в_о Файл  _с_л_о_в_о  назначается  стандартным   файлом
              вывода  (дескриптор  файла  1).  Если  файл не
              существует, он создается; в  противном  случае
              он усекается до нулевой длины.

       >>_с_л_о_в_о
              Файл  _с_л_о_в_о  назначается  стандартным   файлом
              вывода.    Если   файл  существует,  выводимая
              информация добавляется к  его  содержимому;  в
              противном случае файл создается.

       <<_с_л_о_в_о
              Ввод осуществляется до тех пор, пока не встре-
              чается   последовательность   символов  _с_л_о_в_о.
              Полученный локальный файл является стандартным
              файлом  ввода.   Если  какой-либо символ _с_л_о_в_а
              экранирован, не производится никакой интерпре-
              тации  символов  локального файла; в противном
              случае производится подстановка значений пара-
              метров и результатов выполнения команд, символ
              новой строки \n игнорируется, а знак \ исполь-
              зуется  для  экранирования  символов \, $, ` и
              первого символа _с_л_о_в_а.

       <&_ц_и_ф_р_а
              Информация, записываемая в файл с дескриптором
              _ц_и_ф_р_а,  передается  в  стандартный файл вывода
              (см. _d_u_p(2)).

       >&_ц_и_ф_р_а
              Стандартным файлом ввода станет файл  с  деск-
              риптором _ц_и_ф_р_а.

       <&-    Стандартный файл ввода закрыт на запись.

       >&-    Стандартный файл вывода закрыт на чтение.

       Если какой-либо из указанных конструкций предшествует
       цифра,  то дескриптор создаваемого файла определяется
       этой цифрой (вместо 0 или 1 по умолчанию).

ВВССТТРРООЕЕННННЫЫЕЕ ККООММААННДДЫЫ
       Встроенные команды практически не отличаются по своим
       свойствам от остальных команд системы, за исключением
       того, что для них обычно нельзя переопределить  стан-
       дартные файлы ввода/вывода.

       :      Команда не  производит  никаких  действий,  за
              исключением подстановки значений макроперемен-
              ных. Код завершения равен нулю.

       . _ф_а_й_л Выполнить командный  _ф_а_й_л  в  рамках  текущего
              процесса.

       ccdd [_к_а_т_а_л_о_г]
              Объявить указанный _к_а_т_а_л_о_г текущим. Если пара-
              метр  не  задан,  в  качестве  имени  каталога
              используется значение макропеременной HHOOMMEE.


                            -6-                     ДЕМОС/PV


SH(1)                  ДЕМОС. Команды                  SH(1)


       eevvaall [_к_о_м_а_н_д_а ...]
              Провести  все  макроподстановки  и   выполнить
              _к_о_м_а_н_д_у ....

       eexxeecc [_к_о_м_а_н_д_а ...]
              Текущий процесс заменить процессом  выполнения
              _к_о_м_а_н_д_ы   ....    Допускается  переопределение
              стандартных файлов ввода/вывода.

       eexxiitt [_N]
              Прерывание  выполнения  текущего  процесса   с
              кодом  завершения _N. Если число _N отсутствует,
              код завершения определяется  кодом  завершения
              последней выполненной команды.

       eexxppoorrtt [_и_м_я...]
              Указанные макропеременные  автоматически  вво-
              дятся в среду выполняемых впоследствии команд.
              Если параметры не заданы, выдается список имен
              экспортируемых макропеременных.

       llooggiinn [_п_а_р ...]
              Регистрация пользователя в системе без  созда-
              ния   нового   процесса   (эквивалент  команды
              eexxeecc //bbiinn//llooggiinn _п_а_р...).

       nneewwggrrpp [_п_а_р ...]
              Замена текущего идентификатора группы  пользо-
              вателей           (эквивалент          команды
              eexxeecc //bbiinn//nneewwggrrpp _п_а_р...).

       rreeaadd _и_м_я ...
              Из стадартного файла  ввода  считывается  одна
              строка.   Затем макропеременным _и_м_я ... после-
              довательно присваиваются значения  слов,  сос-
              тавляющих  эту строку.  Код завершения команды
              равен нулю во всех случаях, кроме  тех,  когда
              список  параметров  длиннее,  чем число слов в
              считанной строке.

       rreeaaddoonnllyy _и_м_я ...
              Запрещается переопределение перечисленных мак-
              ропеременных.  Если параметры не заданы, выда-
              ется список всех макропеременных, определенных
              как rreeaaddoonnllyy (только для чтения).

       sseett [--eekknnppttuuvvxx [_п_а_р ...]]
              Устанавливает режимы работы интерпретатора sshh.
              Могут задаваться следующие ключи:

              --ee     В   неинтерактивном   режиме   вызывает
                     немедленное  прерывание при обнаружении
                     ошибки в выполнении команды.

              --kk     Все определенные  макропеременные  экс-
                     портируются в среду запускаемых процес-
                     сов.



                            -7-                     ДЕМОС/PV


SH(1)                  ДЕМОС. Команды                  SH(1)


              --nn     Производит только  синтаксическую  про-
                     верку команд.

              --tt     Прерывает  выполнение  процесса   после
                     того,  как  будет  считана  и выполнена
                     одна команда.

              --uu     Устанавливает режим диагностики  ошибки
                     при попытке использовать неопределенные
                     переменные.

              --vv     Устанавливает  режим  печати   вводимых
                     строк по мере их считывания.

              --xx     Распечатывает команды и их параметры по
                     мере выполнения.

              --      Отменяет ключи --xx и --vv.

       Установленные ключи содержатся в  макропеременной  --.
       Остальным параметрам присваиваются значения позицион-
       ных параметров "11, 22, ...".  Если  параметры  команды
       sseett  не  заданы, то она печатает список значений всех
       макропеременных.

       sshhiifftt  Позиционным параметрам "22, 33, ..."  присваива-
              ются  значения  параметров  "11,  22, ..." соот-
              ветственно.

       ttiimmeess  Выдается время,  затраченное  пользователем  и
              системой на выполнение процесса.

       ttrraapp [_к_о_м_а_н_д_а] [_N ...]
              При получении сигналов с перечисленными  номе-
              рами  (см.   _s_i_g_n_a_l(2))  выполняется указанная
              _к_о_м_а_н_д_а.

       uummaasskk [_d_d_d]
              Маске создания файлов пользователя  присваива-
              ется восьмеричный код _d_d_d (см. _u_m_a_s_k(2)). Если
              параметр _d_d_d опущен, выдается текущеее  значе-
              ние маски.

       wwaaiitt [_n]
              Ожидает окончания выполнения процесса с  номе-
              ром  _n и присваивает код его завершения макро-
              переменной ??.

ВВЫЫЗЗООВВ ИИННТТЕЕРРППРРЕЕТТААТТООРРАА
       Если первым символом параметра 00 является  знак  '-',
       то  при  запуске  sshh  считываются  команды  из  файла
       ._p_r_o_f_i_l_e  в  регистрационном  каталоге  пользователя.
       При вызове могут указываться следующие ключи:

       --cc _с_т_р_о_к_а
              Команды считываются из _с_т_р_о_к_и.

       --ss     Команды  считываются  из  стандартного   файла


                            -8-                     ДЕМОС/PV


SH(1)                  ДЕМОС. Команды                  SH(1)


              ввода.   Сообщения интерпретатора записываются
              в стандартный файл диагностик (файл с дескрип-
              тором 2).

       --ii     Интерактивный режим работы интерпретатора.

ФФААЙЙЛЛЫЫ
       $HHOOMMEE/._p_r_o_f_i_l_e      стартовый командный файл
       /_t_m_p/_s_h*            временный файл для '<<'
       /_d_e_v/_n_u_l_l           ст. ввод для фоновых задач
       /_e_t_c/_p_r_o_f_i_l_e        общий стартовый командный файл

ДДООППООЛЛННИИТТЕЕЛЛЬЬННЫЫЕЕ ССССЫЫЛЛККИИ
       _c_s_h(1), _t_e_s_t(1), _e_x_e_c(2), _e_n_v_i_r_o_n(7)

       Имеется отдельное описание sshheellll.

ДДИИААГГННООССТТИИККАА
       Ошибки, обнаруженные интерпретатором (например,  син-
       таксические  ошибки), приводят к тому, что sshh возвра-
       щает код завершения, не равный нулю.  Если  при  этом
       режим работы - неинтерактивный, то выполнение команд-
       ного файла прекращается. Если же режим  работы  инте-
       рактивный,  sh  возвращает  код  завершения последней
       выполненной команды (см. также eexxiitt).



































                            -9-                     ДЕМОС/PV

