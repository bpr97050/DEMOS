
PTY(4)            ДЕМОС. Специальные файлы            PTY(4)


ИИММЯЯ
        ppttyy - псевдотерминалы

ООППИИССААННИИЕЕ
        Драйвер  ppttyy  поддерживает  логические   устройства,
        называемые  _п_с_е_в_д_о_т_е_р_м_и_н_а_л_а_м_и.  Псевдотерминал - это
        пара байториентированных устройств: _m_a_s_t_e_r  (хозяин)
        и  _s_l_a_v_e  (подчиненный).  _s_l_a_v_e-псевдотерминал имеет
        интерфейс, идентичный описанному в  _t_t_y(4).   Обычно
        устройства,  имеющие  интерфейс _t_t_y(4) предоставляют
        доступ к аппаратуре (линиям связи и физическим  тер-
        миналам).   _s_l_a_v_e-псевдотерминал  вместо физического
        устройства предоставляет доступ к _п_р_о_ц_е_с_с_у, управля-
        ющему  этим (логическим) устройством через вход _m_a_s_-
        _t_e_r этого псевдотерминала; т.е.  информация, записы-
        ваемая   в  _m_a_s_t_e_r-вход  псевдотерминала  передается
        _s_l_a_v_e-входу как вводимая с клавиатуры, а информацию,
        записываемую в _s_l_a_v_e-вход управляющий процесс считы-
        вает с _m_a_s_t_e_r-входа псевдотерминала.

        Таким  образом,   программа   работает   со   _s_l_a_v_e-
        псевдотерминалом  как  с  обычным терминалом, однако
        ввод с клавиатуры осуществляется записью  данных  из
        управляющего процесса в _m_a_s_t_e_r-вход, а вывод на тер-
        минал поступает в _m_a_s_t_e_r-вход и  может  быть  оттуда
        прочитан.  По интерфейсу с процессом _s_l_a_v_e-вход сов-
        падает с терминалом, а _m_a_s_t_e_r-вход является прозрач-
        ным байториентированным устройством.

         пользовательские                 управляющий
         процессы                             процесс
                       _s_l_a_v_e        _m_a_s_t_e_r
          "экран"      ======       ======
           wwrriittee   -->|      |-->--|      |---> rreeaadd
                      |======|     |======|
           rreeaadd    <--| ttyp |--<--| ptyp |<--- wwrriittee
          "клавиатура" ======       ======

        Для управления _m_a_s_t_e_r-псевдотерминалом можно исполь-
        зовать следующие запросы системного вызова iiooccttll:

        TTIIOOCCSSTTOOPP   Приостанавливает вывод на  терминал  (как
                   будто  было  нажато  CCTTRRLL//SS).  Не требует
                   аргумента.

        TTIIOOCCSSTTAARRTT  Возобновляет вывод (приостановленный  при
                   помощи  TTIIOOCCSSTTOOPP или записью CCTTRRLL//SS).  Не
                   требует параметра.

        TTIIOOCCPPKKTT    Включает/выключает    _п_а_к_е_т_н_ы_й     режим.
                   Пакетный режим включается указанием нену-
                   левого аргумента и выключается  указанием
                   нулевого параметра (системный вызов iiooccttll
                   требует указания _а_д_р_е_с_а  аргумента,  под-
                   робнее  см.   _i_o_c_t_l(2)).   Когда пакетный
                   режим включен, каждое  чтение  (системным
                   вызовом  rreeaadd) из _m_a_s_t_e_r-входа псевдотер-
                   минала возвращает  данные,  записанные  в


                            -1-                     ДЕМОС/PV


PTY(4)            ДЕМОС. Специальные файлы            PTY(4)


                   _s_l_a_v_e-вход псевдотерминала, с предшеству-
                   ющим нулевым байтом (символически обозна-
                   чаемым  TTIIOOCCPPKKTT__DDAATTAA),  или одним байтом,
                   содержащим некоторую управляющую информа-
                   цию  (состояние псевдотерминала).  В пос-
                   леднем случае биты в байте имеют  следую-
                   щий смысл:

                   TTIIOOCCPPKKTT__FFLLUUSSHHRREEAADD  когда буфер чтения для
                                      терминала опустошен;

                   TTIIOOCCPPKKTT__FFLLUUSSHHWWRRIITTEE когда буфер записи  на
                                      терминал опустошен;

                   TTIIOOCCPPKKTT__SSTTOOPP       когда вывод на  терми-
                                      нал приостановлен (как
                                      по CCTTRRLL//SS);

                   TTIIOOCCPPKKTT__SSTTAARRTT      когда вывод на  терми-
                                      нал возобновлен;

                   TTIIOOCCPPKKTT__DDOOSSTTOOPP     когда ssgg__ssttooppcc  -  это
                                      CCTTRRLL//SS  и  ssgg__ssttaarrttcc -
                                      это CCTTRRLL//QQ;

                   TTIIOOCCPPKKTT__NNOOSSTTOOPP     когда  символы   оста-
                                      новки   и  продолжения
                                      выдачи   отличны    от
                                      CCTTRRLL//SS и CCTTRRLL//QQ.

        TTIIOOCCRREEMMOOTTEE Включает  и  выключает  режим  _у_д_а_л_е_н_н_о_г_о
                   _р_е_д_а_к_т_и_р_о_в_а_н_и_я  ввода  с  псевдотерминала
                   (независимо   от   установки    пакетного
                   режима).

                   В   этом   режиме    ввод    из    _s_l_a_v_e-
                   псевдотерминала   управляется  протоколом
                   _X_O_N/_X_O_F_F  (символами  CCTTRRLL//QQ  и  CCTTRRLL//SS).
                   Кроме  того,  в  этом  режиме отключается
                   редактирование вводимой строки  у  _s_l_a_v_e-
                   входа  несмотря  на на режим работы драй-
                   вера _s_l_a_v_e-псевдотерминала и  установлен-
                   ные для редактирования ввода спецсимволы;
                   все функции такого редактирования  должен
                   выполнять  управляющий  процесс.   Каждая
                   запись  (системным  вызовом   wwrriittee)   на
                   _m_a_s_t_e_r-вход    псевдотерминала    создает
                   отдельный _с_е_г_м_е_н_т потока байтов; при чте-
                   нии  со  _s_l_a_v_e-входа  (системным  вызовом
                   rreeaadd) за один  раз  может  быть  прочитан
                   только  один  сегмент.  Если длина буфера
                   ввода больше размера сегмента, rreeaadd  вер-
                   нет  размер  сегмента.   Таким образом, в
                   обычном режиме каждый сегмент  соответст-
                   вует вводимой строке.  Чтение сегмента из
                   0 байтов эквивалентно чтению конца файла.

                   Запрос   TTIIOOCCRREEMMOOTTEE    применяется    для


                            -2-                     ДЕМОС/PV


PTY(4)            ДЕМОС. Специальные файлы            PTY(4)


                   удаленного редактирования строк в многоо-
                   конных интерфейсах, или  когда  требуется
                   ввод, управляемый протоколом _X_O_N/_X_O_F_F.

ФФААЙЙЛЛЫЫ
        /_d_e_v/_p_t_y[_p-_r][_0-_9_a-_f] _m_a_s_t_e_r-входы псевдотерминалов;
        /_d_e_v/_t_t_y[_p-_r][_0-_9_a-_f] _s_l_a_v_e-входы псевдотерминалов.

ДДООППООЛЛННИИТТЕЕЛЛЬЬННЫЫЕЕ ССССЫЫЛЛККИИ
        _t_t_y(4), _i_o_c_t_l(2), _s_e_l_e_c_t(2x)


















































                            -3-                     ДЕМОС/PV

