

АННОТАЦИЯ

     Описан разработанный М.Н.Флеровым экранный  интерпре-
татор  comint  (также известный как fsh), методы его наст-
ройки для эффективной поддержки различных  работ  в  UNIX-
подобных системах.




























































                            2




ВВЕДЕНИЕ

     comint -  это  интерактивная  оболочка  пользователя,
обеспечивающая основанный на меню интерфейс пользователя с
операционной системой.  Идеологически comint близок к  ин-
терпретатору  Norton  Commander (nc), широко используемому
пользователями MS DOS, однако  иначе  использует  экранное
пространство  и имеет более гибкую и мощную многоуровневую
систему настройки.

     Comint отображает на экране объекты, с  которыми  ак-
тивно работает пользователь (файлы, процессы, другие опре-
деленные пользователем объекты), в результате чего в боль-
шинстве  случаев  отпадает необходимость в специальных ко-
мандах просмотра (ls, ps, pwd и т.п.).  Выбор  объектов  и
такие  характерные действия над ними, как создание, удале-
ние, переименование, просмотр,  копирование,  сравнение  и
т.п.  реализуются нажатием небольшого числа функциональных
клавиш, что позволяет достаточно легко работать с  клавиа-
турой  "вслепую"  и  использовать  более мнемоничные имена
объектов без потери скорости ввода команд.

     Реакцию на нажатие той или иной  функциональной  кла-
виши пользователь может выбрать по своему усмотрению, при-
чем эта реакция может зависеть (или не зависеть) от  теку-
щего каталога и/или от характера выбранного объекта (ката-
лог, текстовый файл, объектный модуль, программа на  форт-
ране,  библиотека, модуль в библиотеке, сетевой узел, про-
цесс, и т.п.).  Реакция может быть описана в  файле  наст-
ройки  как  строка произвольной длины и сложности на языке
Shell (с возможными вставками внутренних команд и внутрен-
них  переменных comint'а).  Это позволяет при помощи наст-
ройки comint'а создавать для  каждого  пользователя  и/или
каждого  каталога  среду с индивидуальными свойствами, эф-
фективно  поддерживающую  определенный  вид   деятельности
(например, отладку программ на Си, администрирование сети,
управление специальным оборудованием, обучение, делопроиз-
водство и т.п.).

НАИБОЛЕЕ ДОСАДНЫЕ ОГРАНИЧЕНИЯ

     Когда делали comint, про Norton еще  никто  не  знал.
Еще  досаднее, что Нортон не знал про comint.  Иначе он не
стал бы делать Norton.  Люди, травмированные Norton'ом,  с
трудом осваивают comint. :-)

     В разное время к  развитию  comint'а  приложили  руку
О.Губа,  П.Брусиловский,  А.Рыжов.  К сожалению, эти дора-
ботки пока не удалось свести в единое целое, и данное опи-
сание может оказаться не совсем верным или полным для дру-
гой ветви из множества его версий.

     Поскольку comint был разработан  в  эпоху  алфавитно-
цифровых  терминалов,  он  не использует средства графики,
псевдографики и цвет (по крайней мере, данная ветвь).






                            3




     П.Л.Брусиловским comint был  адаптирован  для  работы
через  termcap,  однако данная версия использует некоторые
нестандартные наименования клавиш и управляющих  символов.
Поэтому при переносе comint'а из одной системы UNIX в дру-
гую необходима некоторая борьба с файлом /etc/termcap.   В
наихудшем случае рекомендуется установить в среде перемен-
ную TERMCAP=имя_файла и использовать свой  termcap  вместо
стандартного.   Это, кстати, поможет и в борьбе с редакто-
ром re и другими хорошими программами,  наспех  перетащен-
ными из ДЕМОС и оставшимися в таком виде.  termcap для SCO
UNIX прилагается.

         ОСНОВНЫЕ ПОНЯТИЯ. СТАНДАРТНАЯ НАСТРОЙКА.


     Как правило, содержимое  экрана  отражает  содержимое
текущего  каталога,  имя  текущего каталога, имя пользова-
теля, фоновые процессы, дату и время.   Объект  (как  пра-
вило,  файл), возле которого стоит курсор, является "теку-
щим".  Если в текущем каталоге нет файлов, то курсор нахо-
дится  в середине экрана, а понятие "текущий объект" неоп-
ределено.

     В левом верхнем углу обычно присутствует знак +.  Это
режим  "сокращенного"  показа  (чтобы не перегружать экран
второстепенными объектами).  В этом режиме не показываются
файлы,  имена которых начинаются с точки, а также "зависи-
мые" файлы.  Например, если в каталоге есть файлы  prog.c,
prog.c.Z,  prog.c.b,  prog.s и prog.o, то последние четыре
файла comint считает "зависящими" от первого и не  показы-
вает.   Выключить/включить  этот  режим  можно клавишей +.
Следует помнить, что  в  режиме  сокращенного  показа  при
стирании/переименовании     "главного"     файла    comint
стирает/переименовывает и все "зависящие" от него.  Если +
не горит и файлы . и .. присутствуют в меню, то синхронное
стирание/переименование  зависимых  файлов  не  происходит
(правила зависимости не действуют).  Comint ждет ввода од-
ного символа (нажатия одной клавиши).

     Если  пользователь  не  предпринимал  самостоятельных
действий по настройке comint'а, то реакции на нажатие кла-
виш будут следующими:

Вызов подсказки -
     это клавиша <CTRL-H>, то есть нажатие клавиши  h  при
     нажатой  клавише  CTRL  или СУ.  Приводит к выдаче на
     экран одного кадра из файла подсказок.  Другие  кадры
     подсказки  можно просмотреть, нажав клавиши, перечис-
     ленные в нижней части данного  кадра  подсказки.   Не
     огорчайтесь,  если  подсказка  не выдается - просто в
     систему не положили нужный файл.  К тому  же  Вы  все
     равно уже читаете этот текст.


Выбор объекта
     осуществляется передвижением курсора при помощи  кла-
     виш со стрелками в правой части клавиатуры.  Эти кла-




                            4




     виши вызывают перемещение курсора к  другому  объекту
     (если таковой имеется). Этот объект становится "теку-
     щим".  Движение  курсора  происходит  циклически,  то
     есть для последнего объекта в меню следующим является
     первый объект меню.

Вход в объект
     oсуществляется нажатием клавиши  "пробел"  (в  нижней
     части клавиатуры).  Кроме того, для этих целей иногда
     используется клавиша RETURN, ENTER или ВК.  Смысл по-
     нятия  "вход  в объект" зависит от характера текущего
     объекта.  Если это

каталог   - происходит переход в  этот  каталог,  то  есть
            спуск  по  дереву  на  один уровень от корня в
            сторону листа.  Выбранный  каталог  становится
            текущим  каталогом, на экране отображается его
            содержимое, а  последний  (по  алфавиту)  файл
            этого каталога становится текущим объектом.

псевдокаталог
          - происходит "вход" в псевдокаталог.   Характер-
            ным  примером  псевдокаталога является библио-
            тека в формате ar(1), и для работе  в  библио-
            теке  в стандартной настройке comint'а предус-
            мотрены соответствующие реакции.  При  "входе"
            в  библиотеку на экране отображается ее содер-
            жимое.  С объектами, которые являются  файлами
            внутри  библиотеки, допускаются многие из опе-
            раций (стирание, переименование,  копирование,
            просмотр,  редактирование и т.п.) с некоторыми
            естественными ограничениями.  Скорость  выпол-
            нения  этих  операций  несколько ниже, чем при
            аналогичных операциях в обычном  (не  псевдо-)
            каталоге,  поскольку  comint  неявно запускает
            операции библиотекаря ar(1).

текст     - то есть текстовый файл - запускается  редактор
            текстов  red(1).   Если пользователь предпочи-
            тает работать  с  другим  редакторов  текстов,
            следует изучить раздел "ИЗМЕНЕНИЕ НАСТРОЙКИ".

данные    - то есть файл с неизвестной comint'у структурой
            -  запускается редактор modify(1) для редакти-
            рования файла в кодах.  Если modify  не  уста-
            новлен  в системе или не виден - comint просто
            ругается по-русски. Так что  если  система  не
            руссифицирована, Вы скорее всего не поймете.

Пометка объекта.
     Текущий объект может быть помечен одним из символов:

*         - при помощи клавиши '*' или ':'. Объекты, поме-
            ченные  звездочкой,  могут быть затем скопиро-
            ваны (в том числе в другой  каталог)  или  ис-
            пользованы как аргументы команды (см.ниже).





                            5




-         - при помощи клавиши  '-'.  Объекты,  помеченные
            минусом,  могут  быть  затем  стерты (см. ниже
            "Стирание объекта").  Знак  равенства,  совме-
            щенный на этой же клавише, в стандартной наст-
            ройке используется для других целей (см.  "Пе-
            реименование объекта").

<         - при помощи  клавиши  '<'.  Объект,  помеченный
            знаком '<', далее используется как стандартный
            ввод команды (см. "Запуск объекта",  "Выполне-
            ние команд").

Запуск объекта.
     Если текущий объект является  выполняемой  программой
     (в  том  числе  командным файлом на языке sh), то при
     нажатии клавиши ТАБ возле этого объекта он будет  за-
     пущен  на  выполнение.   Если  при  этом есть объекты
     (файлы), ранее помеченные звездочками, они становятся
     аргументами  запущенной  программы  (в том порядке, в
     каком были помечены), а файл, помеченный знаком  '<',
     становится  стандартным  вводом  для  этой программы.
     Другим примером "запуска" является распаковка  файлов
     с суффиксами .Z или .z.

Выполнение команд,
     то есть запуск командной строки  на  языке  sh,  осу-
     ществляется после нажатия символа '!'.  При этом com-
     int предлагает ввести командную  строку.   При  вводе
     командной  строки допускается ее редактирование, ана-
     логично редактированию строк в  текстовом  редакторе,
     то  есть  перемещение  курсора по строке влево-вправо
     (клавишами со стрелками), вставка/удаление  символов,
     удаление  остатка строки за курсором и т.п..  Клавиши
     со стрелками вверх/вниз служат для перехода к  редак-
     тированию  передыдущих  (ранее  введенных)  командных
     строк (history).  Объем буфера под history ограничен,
     слишком старые строки удаляются. Удаляются и не слиш-
     ком старые, если вводится много длинных строк.


стирание объекта
     какая именно клавиша используется для стирания, зави-
     сит  от  типа  используемой клавиатуры.  Уточнить это
     можно, вызвав minihelp.  Попробуйте `  (обратная  ка-
     вычка).  Стираемые объекты должны быть предварительно
     помечены знаком -. Каталоги помечаются минусом только
     после предупредительного свистка. Зато вытираются ре-
     курсивно.


     А теперь читайте Флерова  (comint.1).   Помните,  что
описанная  им версия и настройка относятся к 1985 г.  Наз-
вания клавиш и управляющих  символов  могут  подразумевать
какой-нибудь  фрязинский монитор от ДВК-2.  Почитайте дру-
гие тексты в этом каталоге.  Чтобы глубоко  освоить  меха-
низм  настройки, вам, несомненно, придется до дыр зачитать
все доступные настроечные файлы.  Эстеты могут изучить ис-




                            6




ходники  comint'а - тоже помогает.  Если совсем не получа-
ется  - спрашивайте.

 .
 .                      Андрей Рыжов
 .
 .                      +7 (095) 334-1056 (дом.)
 .
 .                               192-8849 (раб.)
 .                               192-8071
 .
 .                      E: rygoff@algeok.msk.su
 .















































