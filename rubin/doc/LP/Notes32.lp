

                           -- 11 --


                     СУБД Рубин 2.15.3

                        для Демос-32


            Замечания по реализации и установке





ССооссттаавв ссииссттееммыы

     Данная версия СУБД Рубин 2.15.3 для Демос-32 предназна-
чена  для  работы на совместимых с VAX/11 ЭВМ в операционной
системе Демос-32 или Unis 4.3  BSD.  Система  требует  около
2.2 мб памяти на дисках.  В составе системы поставляются:

1)   Замечания по реализации  и  установке  (печатный  доку-
     мент);

2)   Лента на плотности 1600 bps, содержащая два файла:
     - документация по системе;

     - система Rubin 2.15.3.

3)   дополнительно могут быть  поставлены  тексты  некоторых
     библиотек для работы с базой напрямую (библиотека мето-
     дов  доступа),  и  напечатанная  документация  по  СУБД
     РУБИН.

     В файл с системой в  формате  TAR   записаны  следующие
справочники:


./bin
     выполняемые файлы системы RUBIN;

./lib/libq.a
     библиотека подпрограмм для работы Equel;

./files
     управляющие файлы для Rubin.

./data/base/.Keep
     этот файл  служит  просто  для  сохранения  справочника
     ./data/base,  в котором размещаются (по умолчанию) базы
     данных.

./source/h
     некоторые include-файлы для программ на Equel.

     Файл с документацией (первый файл на ленте) также запи-
сан программой tar и содержит следующие справочники:









                           -- 22 --


./doc/LP
     сформатированные документы в коде КОИ-8 для  печати  на
     обычном принтере;

./doc/{quel,demos,files,error,other,...)
     несформатированная справочная документация;

     В документацию входят  следующие  документы  (приведены
основы названия файлов, в которых они записаны):


Notes32
     - Замечания по системе и ее установке;

Intro
     - Введение в документацию;

Ref* - Справочное руководство;

Tutorial
     - Ознакомительное руководство по Quel;

Equel
     - Руководство по языку Equel;

maintain
     - Руководство по сопровождению системы;

     Дополнительные файлы могут включать:

./lib/{gutil,iutil,ctlmod}
     готовые библиотеки;

./source/h
     файлы описаний;

./source/iutil/*.[ch]
     исходные тексты библиотеки методов доступа;

./source/support/{Makefile,printr.c}
     исходные тексты программы "printr", которая служит при-
     мером в написании программ с прямым доступом к базе.

ТТррееббоовваанниияя кк ссииссттееммее ДДееммоосс--3322

     Для работы "rubin" система должна  иметь  "запас  проч-
ности"  в  виде свободного места в таблицах файлов (параметр
FILES), I-узлов (INODES), и в размере SWAP-области. Рекомен-
дуется  добавить  примерно по 20 файлов, 10 I-узлов и по 500
кб на SWAP-области на каждого одновременно работающего поль-
зователя "rubin" (если их будет больше 2-х - 3-х).












                           -- 33 --


ППооссттааннооввккаа ссииссттееммыы

     Постановка производится по следующим этапам:

1)   Завести пользователя "rubin" в системе, пользуясь стан-
     дартными  средствами  ОС;  В  качестве командного языка
     рекомендуется указывать C-shell;

2)   Войти в пользователя "rubin".

3)   Если система ставится не впервые, стереть старые  спра-
     вочники, за исключением файла files/users и справочника
     с базами data/base/*.


4)   Считать систему с ленты, набирая (имя ленты может отли-
     чаться от /dev/nrmt8):

      tar xvf /dev/nrmt8

     Эта команда повторяется для  каждого  файла  на  ленте,
     причем для  перехода к следующему файлу дается команда:

      mt -t /dev/nrmt8 fsf


5)   Войти в суперпользователя:

      su


6)   Выполнить команду:

      make idemos


7)   Выйти из суперпользователя и, если система  ставится  в
     первый раз, набрать:


      ./bin/usersetup


     Затем отредактировать файлы .cshrc и .login.   Добавле-
ние  в  переменную  "path"  ~rubin/bin  необходимо оставить.
Если  вы  используете  не  редактор  "/bin/red"  и  шэлл  не
"/bin/csh",  то отредактируйте файл "files/startup", заменив
там /bin/re и /bin/csh на то, чем вы пользуетесь.

     Для  работы СУБД использует специальный сервер блокиро-
вок  rubin_lock.  Он переписывается при постановке системы в
/etc/rubin_lock, а команда  для  его  запуска  помещается  в
/etc/rc.  При  первой  постановке  нужно  либо запустить его
вручную:









                           -- 44 --


 /etc/rubin_lock

либо перевызвать систему и убедиться  в  наличии  в  системе
процесса rubin_lock.

ППррооввееррккаа ссииссттееммыы

     Работа СУБД в пакетном  режиме  проверяется  программой
создания демонстрационной базы данных "demodb":

 demodb имя_базы

С созданной базой можно работать по инструкции начинающим.

     Тесты    для    Equel    содержатся    в    справочнике
doc/Examples/*.q.   Если  все  установлено правильно, должна
проходить команда:

 make clean
 make

и должны работать полученные программы.

Внимание. После установки системы проверьте  наличие  файлов
вставок      "/usr/include/rubin/*.h"      и      библиотеки
/usr/lib/libq.a,  а  в  путь  поиска  программ  программиста
(переменная "path") должен входить справочник "~rubin/bin".

ЗЗааммееччаанниияя ппоо ррееааллииззааццииии RRUUBBIINN 22..1155..33

     Для работы СУБД на медленной СМ-1700 рекомендуется сле-
дующее:

1)   Использовать ключи "-b" - выключение отложенных измене-
     ний,  и  "-rheap"  -  создавать  рабочие отношения типа
     "heap" - всегда, когда  это  возможно.   При  работе  в
     "Equel" ключи задаются в операторе вызова "rubin".

2)   После  заведения  новых  отношений  в  базе   выполнять
     команду "sysmod".

3)   После любого сбоя выполнять  "restore" и "purge -f".

4)   Следовать рекомендациям, приведенным в  руководстве  по
     Equel.

     Выполнение этих требований поднимает производительность
в 2 - 3 раза.















                           -- 55 --


ООссннооввнныыее ооттллииччиияя  оотт  ссттааррыыхх  ввееррссиийй  ((22..1144  ддлляя  ССММ--11442200  ии
тт..пп..))

     - Новые типы данных: d4 - дата и t4 - время, и  функции
       для работы с ними.

     - Новый объект - переменная  ("Serial")  для  получения
       уникальных номеров при занесении данных в базу;

     - Новый тип организации памяти - SHASH , и новые описа-
       тели модификации отношений - "tuples" и другие;

     - Новый метод блокировки на  основе  системного  вызова
       "FCNTL",   что  не  требует  специального  устройства
       "/dev/lock".



ИИззввеессттнныыее оошшииббккии

1)   Если создать отношение с пустыми текстовыми полями опе-
     ратором "Retrieve" в режиме умолчания (то есть в упако-
     ванной форме "cheapsort"), а затем обновлять эти пустые
     поля оператором "Replace", может возникнуть ошибка сис-
     темы. Метод устранения - устанавливайте в таких случаях
     ключом  "-rheap" другой тип рабочих отношений - не упа-
     кованный (см.  "rubin(DEMOS)" и "modify(QUEL)" в  спра-
     вочном руководстве.

ООттллииччиияя ввееррссииии 22..1155..33 оотт 22..1155..22

2)   Созданы библиотеки Equel для работы со  всеми  моделями
     памяти.

3)   Отлажен оптимизированный поиск по шаблонам вида
      поле="Текст*" или поле="[А-Г]*"

     в случае, если "поле" является ключом, который хранится
     в ISAM или CISAM.

4)   Исправлена ошибка в создании ISAM для  больших  (больше
     32000  уникальных значение и 60000 всех значений) отно-
     шений.

5)   Введена  возможность  задавать  объем  памяти,  которую
     использует  внутренняя  программа  сортировки (ksort7).
     Если задана переменная KSORTMEM, то она трактуется  как
     объем  оперативной  памяти  в килобайтах, которая отво-
     дится  программе  ksort.  Это  позволяет  на  машине  с
     памятью, например, 16 мб, установив

      setenv KSORTMEM 6000

     ускорить в несколько раз сортировку  больших  отношений









                           -- 66 --


     (отношения  занимающие  меньше  6-ти  мегабайт при этом
     сортируются просто в памяти) и, соответственно,  выпол-
     нение  таких запросов, которые вызывают скрытую модифи-
     кацию отношений.

6)   Имеется версия системы для:
      Xenix-286
      Xenix-386
      Unix 5.3/IX
      Unix V.3/Besta
      Demos/32

      Готовится версия для Demos 2.2/СМ и Демос 2.2/СМ1425.

ЗЗааммееччаанниияя ии ппррееддллоожжеенниияя

     Просим о всех замеченных ошибках сообщать разработчикам
системы  в кооператив "DEMOS/*", Рудневу А.П., или электрон-
ной  почтой на alex@kiae.su (сети RelCom, InterNet, Euunet и
связанные с ними).









































