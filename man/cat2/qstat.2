
QSTAT(2)          ДЕМОС. Системные вызовы           QSTAT(2)


ИИММЯЯ
       qqssttaatt, qqffssttaatt - получение информации о файле.

ФФООРРММААТТ
       #iinncclluuddee <_s_y_s/_t_y_p_e_s._h>
       #iinncclluuddee <_s_y_s/_q_s_t_a_t._h>

       qqssttaatt (_n_a_m_e, _b_u_f)
       cchhaarr **_n_a_m_e;
       ssttrruucctt qqssttaatt **_b_u_f;

       qqffssttaatt (_f_d, _b_u_f)
       iinntt _f_d;
       ssttrruucctt qqssttaatt **_b_u_f;

ООППИИССААННИИЕЕ
       Системные вызовы qqssttaatt и qqffssttaatt  выполняют  действия,
       аналогичные  вызовам  ssttaatt и ffssttaatt. Несколько отлича-
       ется только структура предоставляемой информации:

       ssttrruucctt qqssttaatt {
           cchhaarr    _q_s__f_l_a_g;
           cchhaarr    _q_s__c_o_u_n_t;
           ddeevv__tt   _q_s__d_e_v;     /* Устройство */
           iinnoo__tt   _q_s__n_u_m_b_e_r;  /* I-номер */
           uu__sshhoorrtt _q_s__m_o_d_e;    /* статус файла */
           sshhoorrtt   _q_s__n_l_i_n_k;   /* Число связей */
           sshhoorrtt   _q_s__u_i_d;     /* Владелец */
           sshhoorrtt   _q_s__g_i_d;     /* Группа владельца */
           ooffff__tt   _q_s__s_i_z_e;    /* Размер файла */
           uunniioonn {
               /* Для обычных файлов */
               ssttrruucctt {
                 /* Номера, занимаемых блоков */
                   ddaaddddrr__tt _q_s__a_d_d_r[_N_A_D_D_R];
                 /* Номер, последнего считанного блока */
                   ddaaddddrr__tt _q_s__l_a_s_t_r;
               };
               /* Для специальных файлов */
               ssttrruucctt {
                   ddaaddddrr__tt _q_s__r_d_e_v;
               };
               /* Для специальных файлов типа "q" */
               ssttrruucctt {
                   /* Число занятых секторов */
                   ddaaddddrr__tt __q_s__q_u_s_e_d;
                   /* Ограничение пространства */
                   ddaaddddrr__tt __q_s__q_m_a_x;
               };
           }   _q_s__u_n;
        /* Времена изменения файла */
           ttiimmee__tt _q_s__a_t_i_m_e; /* Последний просмотр */
           ttiimmee__tt _q_s__m_t_i_m_e; /* Последняя модификация */
           ttiimmee__tt _q_s__c_t_i_m_e; /* Посл.изменение статуса */
       };

       Большая часть полей этой структуры совпадает по  зна-
       чению  с  подобными  полями  структуры,  возвращаемой


                            -1-                      ДЕМОС/P


QSTAT(2)          ДЕМОС. Системные вызовы           QSTAT(2)


       системным вызовом ssttaatt. Отличием является объединение
       _q_s__u_n,  которое содержит информацию, болше соответст-
       вующую типу файла.

       В отличие от ffssttaatt, системный вызов qqffssttaatt предостав-
       ляет  информацию  и  о  межпроцессных каналах. В этом
       случае значения _q_s__n_l_i_n_k и _q_s__m_o_d_e равны 0,  значение
       qqss__ssiizzee соответствует числу байт, накопленных в межп-
       роцессном канале, а времена изменения файла не  имеют
       смысла.

ЗЗННААЧЧЕЕННИИЕЕ
       Если можно  получить  состояние  файла,  возвращается
       ноль; если файл не найден, возвращается -1.

ККООДДЫЫ ООШШИИББООКК
       При  неудачном  завершении  вызова  qqssttaatt  переменная
       eerrrrnnoo может принимать следующие значения:

       [EENNOOTTDDIIRR]   Указанное имя содержит компоненту,  кото-
                   рая не является каталогом.

       [EENNOOEENNTT]    Задано слишком  длинное  или  пустое  имя
                   файла.  Указанный файл не существует.

       [EEAACCCCEESS]    Какой-либо из каталогов, входящих  в  имя
                   файла, не доступен для просмотра.

       [EEFFAAUULLTT]    Адреса аргументов системного вызова выхо-
                   дят  за границы памяти, доступной данному
                   процессу.

       [EELLOOOOPP]     Число косвенных ссылок в указанном  имени
                   превышает  максимально  допустимое значе-
                   ние.

       При  неудачном  завершении  qqffssttaatt  переменная  eerrrrnnoo
       может принимать следующие значения:

       [EEFFAAUULLTT]    Адреса аргументов системного вызова выхо-
                   дят  за границы памяти, доступной данному
                   процессу.

       [EEBBAADDFF]     Значение _f_d не соответствует  дескриптору
                   открытого файла.

ДДООППООЛЛННИИТТЕЕЛЛЬЬННЫЫЕЕ ССССЫЫЛЛККИИ
       _c_h_m_o_d(2), _c_h_o_w_n(2), _s_t_a_t(2), _u_t_i_m_e(2)












                            -2-                      ДЕМОС/P

