

                           -- 11 --


                     СУБД Рубин 2.15.3

                 для XENIX-386 и Xenix-286


            Замечания по реализации и установке





ССооссттаавв ссииссттееммыы

     Данная версия СУБД Рубин 2.15.1 для XENIX-386 и  XENIX-
286(и UNIX 386/ix) предназначена для работы на совместимых с
IBM PC ЭВМ на базе микропроцессора INTEL-80386 или INTEL-286
системах  Xenix  2.3 и старше (версия для XENIX-386) и XENIX
2.2 и старше (версия для XENIX-286).  Система требует  около
2.2  мб памяти на жестких дисках.  В составе системы постав-
ляются:

1)   Замечания по реализации и установке;

2)   2 основные дискеты с СУБД РУБИН для Xenix-386 или
     2 основные дискеты  с  СУБД  РУБИН  для  Xenix-386  или
     Xenix-286;

3)   1 дискета с документацией для Xenix и Unix 5.3;

4)   дополнительно может быть поставлена 1 дискета с с неко-
     торыми  библиотеками  и  исходными файлами для работы с
     базой напрямую (библиотека методов доступа).

5)   напечатанная документация по СУБД РУБИН.

     На дискеты с системой записаны следующие справочники:


./bin
     выполняемые файлы системы RUBIN;

./lib/libq.a
     библиотека подпрограмм для работы Equel;
      либо ./lib/libq.a,  ./lib/Mlibq.a,  ./lib/Llibq.a  для
     работы  Equel в малой, средней и большой моделях памяти
     на Xenix-286;

./files
     управляющие файлы для Rubin.

./data/base/.Keep
     этот файл  служит  просто  для  сохранения  справочника
     ./data/base,  в котором размещаются (по умолчанию) базы
     данных.









                           -- 22 --


./source/h
     некоторые include-файлы для программ на Equel.

./doc/{quel,demos,files,error,other,...)
     несформатированная справочная документация;

     Дискеты с документацией включают:

./doc/LP
     сформатированные документы в коде КОИ-8 для  печати  на
     обычном принтере;

./doc/LJ
     сформатированные документы и файл загрузки  фонтов  для
     печати  на  лазерном  принтере;  поставляется  дополни-
     тельно.

     В документацию входят  следующие  документы  (приведены
основы названия файлов, в которых они записаны):


Notes286/Notes386
     - Замечания по системе и ее установке;

Intro
     - Введение в документацию;

Ref* - Справочное руководство;

Tutorial
     - Ознакомительное руководство по Quel;

Equel
     - Руководство по языку Equel;

maintain
     - Руководство по сопровождению системы;

     Дискеты со вспомогательными  библиотеками  поставляются
дополнительно и включают справочники:

./lib/{gutil,iutil,ctlmod}
     готовые библиотеки;

./source/h
     файлы описаний;

./source/iutil/*.[ch]
     исходные тексты библиотеки методов доступа;

./source/support/{Makefile,printr.c}
     исходные тексты программы "printr", которая служит при-
     мером в написании программ с прямым доступом к базе.










                           -- 33 --


ТТррееббоовваанниияя кк ссииссттееммее XXEENNIIXX

     Для работы "rubin" система должна  иметь  "запас  проч-
ности"  в  виде свободного места в таблицах файлов (параметр
FILES), I-узлов (INODES), и в размере SWAP-области. Рекомен-
дуется  добавить  примерно по 20 файлов, 10 I-узлов и по 500
кб на SWAP-области на каждого одновременно работающего поль-
зователя "rubin" (если их будет больше 2-х - 3-х).


ППооссттааннооввккаа ссииссттееммыы

     Постановка производится по следующим этапам:

1)   Завести пользователя "rubin" в системе, пользуясь стан-
     дартными  средствами  ОС;  В  качестве командного языка
     рекомендуется указывать C-shell;

2)   Войти в пользователя "rubin".

3)   Если система ставится не впервые, стереть старые  спра-
     вочники, за исключением файла files/users и справочника
     с базами data/base/*.


4)   Считать систему с дискет, набирая:

      tar xvf /dev/rinstall

     Эта команда повторяется для каждой из дискет с системой
     и  документацией; (то есть 2 раза при считывании дискет
     с системой и 1 раз - с документацией,  если  ее  решено
     считать);

5)   Войти в суперпользователя:

      su


6)   Выполнить команду:

      make ix386

     для Xenix-386, или

      make ix286

     для Xenix-286.

7)   Выйти из суперпользователя и, если система  ставится  в
     первый раз, набрать:

      ./bin/usersetup










                           -- 44 --


     Затем, если вы не используете пакет расширения  системы
LOCAL  (справочник /usr/local), отредактировать файлы .cshrc
и      .login,      убрав       оттуда       ссылку       на
/usr/local/.{login.prompt,cshrc}.   Добавление  в переменную
"path" ~rubin/bin необходимо оставить.  Если вы  используете
не  редактор  "/bin/red" и шэлл не "/bin/csh", то отредакти-
руйте файл "files/startup", заменив там /usr/local/bin/re  и
/bin/csh на то, чем вы пользуетесь.


ППррооввееррккаа ссииссттееммыы

     Работа СУБД в пакетном  режиме  проверяется  программой
создания демонстрационной базы данных "demodb":

 demodb имя_базы

С созданной базой можно работать по инструкции начинающим.

     Тесты    для    Equel    содержатся    в    справочнике
doc/Examples/*.q.   Если  все  установлено правильно, должна
проходить команда:

 make clean
 make

и должны работать полученные программы.

Внимание. После установки системы проверьте  наличие  файлов
вставок      "/usr/include/rubin/*.h"      и      библиотеки
/usr/lib/386/Slibq.a, а в путь поиска программ  программиста
(переменная "path") должен входить справочник "~rubin/bin".


ЗЗааммееччаанниияя ппоо ррееааллииззааццииии RRUUBBIINN ддлляя XXeenniixx--228866

     В связи с  ограниченной  адресацией  памяти  RUBIN  для
Xenix-286 собран в виде нескольких взаимодействующих процес-
сов. Такое взаимодействие приводит к  некоторому  замедлению
системы.  В тех случаях, когда необходимо максимальное быст-
родействие, рекомендуется следующее:

1)   Создавать базы данных без работы с виртуальными отноше-
     ниями  и  защитой  (ключ  -q команды "creatdb") во всех
     случаях, когда это возможно;

2)   Использовать ключи "-b" - выключение отложенных измене-
     ний,  и  "-rheap"  -  создавать  рабочие отношения типа
     "heap" - всегда, когда  это  возможно.   При  работе  в
     "Equel" ключи задаются в операторе вызова "rubin".

3)   После  заведения  новых  отношений  в  базе   выполнять
     команду "sysmod".










                           -- 55 --


4)   После любого сбоя выполнять  "restore" и "purge -f".

5)   Следовать рекомендациям, приведенным в  руководстве  по
     Equel.

     Выполнение этих требований поднимает производительность
в 2 - 3 раза.


ООссннооввнныыее ооттллииччиияя  оотт  ссттааррыыхх  ввееррссиийй  ((22..1144  ддлляя  ССММ--11442200  ии
тт..пп..))

     - Новые типы данных: d4 - дата и t4 - время, и  функции
       для работы с ними.

     - Новый объект - переменная  ("Serial")  для  получения
       уникальных номеров при занесении данных в базу;

     - Новый тип организации памяти - SHASH , и новые описа-
       тели модификации отношений - "tuples" и другие;

     - Новый метод блокировки на  основе  системного  вызова
       "FCNTL",   что  не  требует  специального  устройства
       "/dev/lock".



ИИззввеессттнныыее оошшииббккии

1)   Если создать отношение с пустыми текстовыми полями опе-
     ратором "Retrieve" в режиме умолчания (то есть в упако-
     ванной форме "cheapsort"), а затем обновлять эти пустые
     поля оператором "Replace", может возникнуть ошибка сис-
     темы. Метод устранения - устанавливайте в таких случаях
     ключом  "-rheap" другой тип рабочих отношений - не упа-
     кованный (см.  "rubin(DEMOS)" и "modify(QUEL)" в  спра-
     вочном руководстве.

ООттллииччиияя ввееррссииии 22..1155..33 оотт 22..1155..22

2)   Созданы библиотеки Equel для работы со  всеми  моделями
     памяти.

3)   Отлажен оптимизированный поиск по шаблонам вида
      поле="Текст*" или поле="[А-Г]*"

     в случае, если "поле" является ключом, который хранится
     в ISAM или CISAM.

4)   Исправлена ошибка в создании ISAM для  больших  (больше
     32000  уникальных значение и 60000 всех значений) отно-
     шений.











                           -- 66 --


5)   Введена  возможность  задавать  объем  памяти,  которую
     использует  внутренняя  программа  сортировки (ksort7).
     Если задана переменная KSORTMEM, то она трактуется  как
     объем  оперативной  памяти  в килобайтах, которая отво-
     дится  программе  ksort.  Это  позволяет  на  машине  с
     памятью, например, 16 мб, установив

      setenv KSORTMEM 6000

     ускорить в несколько раз сортировку  больших  отношений
     (отношения  занимающие  меньше  6-ти  мегабайт при этом
     сортируются просто в памяти) и, соответственно,  выпол-
     нение  таких запросов, которые вызывают скрытую модифи-
     кацию отношений.

6)   Имеется версия системы для:
      Xenix-286
      Xenix-386
      Unix 5.3/IX
      Unix V.3/Besta
      Demos/32

      Готовится версия для Demos 2.2/СМ и Демос 2.2/СМ1425.

ЗЗааммееччаанниияя ии ппррееддллоожжеенниияя

     Просим о всех замеченных ошибках сообщать разработчикам
системы в кооператив "DEMOS/*", Рудневу А.П.

































