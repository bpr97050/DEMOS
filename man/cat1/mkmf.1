
MKMF(1)                ДЕМОС. Команды                MKMF(1)


ИИММЯЯ
       mmkkmmff - программа построения _m_a_k_e-файлов

ФФООРРММААТТ
       mmkkmmff [--ccddiill] [--ff _m_a_k_e_f_i_l_e] [--FF _ш_а_б_л_о_н]
            [_м_а_к_р_о_и_м_я=_з_н_а_ч_е_н_и_е ...]

ООППИИССААННИИЕЕ
       mmkkmmff создает управляющий файл программы  mmaakkee.   Сна-
       чала  mmkkmmff  выбирает в рабочем каталоге и вставляет в
       _m_a_k_e-файл имена всех исходных файлов.  Затем  опреде-
       ляет,  от  каких  _i_n_c_l_u_d_e-файлов зависят эти исходные
       файлы,  генерирует  для  каждого  из  них  информацию
       (граф)  зависимостей  и  заносит  ее в _m_a_k_e-файл. Для
       обозначения исходных файлов используется  стандартный
       набор суффиксов:

       ._c   Си
       ._e   Efl
       ._F   Фортран
       ._f   Фортран
       ._h   _I_n_c_l_u_d_e-файлы языка Си
       ._i   _I_n_c_l_u_d_e-файлы языка Паскаль
       ._l   Lex или Lisp
       ._o   Объектные файлы
       ._p   Паскаль
       ._r   Ратфор
       ._s   Ассемблер
       ._y   Yacc

       Перед  началом  сборки  _m_a_k_e-файла  проверяется   его
       существование.  Если ключ --ff отсутствует, то по умол-
       чанию создается файл _M_a_k_e_f_i_l_e.

       _M_a_k_e-файл, созданный с помощью программы mmkkmmff,  можно
       затем отредактировать обычным текстовым редактором. С
       помощью mmkkmmff можно изменить значения макропеременных,
       определяемых в _m_a_k_e-файле.

       По умолчанию mmkkmmff создает _m_a_k_e-файлы для сборки прог-
       рамм.  Для  создания _m_a_k_e-файлов для сборки библиотек
       можно использовать ключ --ll.

       ССттааннддааррттнныыее ииммееннаа ппррааввиилл

       В _m_a_k_e-файле, созданном с помощью mmkkmmff,  определяются
       следующие функции программы mmaakkee:

       Имя правила   Функции программы mmaakkee

       aallll           Трансляция  и  загрузка  программы  или
                     библиотеки.

       cclleeaann         Удаление всех ненужных файлов.

       ddeeppeenndd        Перегенерация графов зависимостей.

       eexxttrraacctt       Выборка  всех   объектных   файлов   из


                            -1-                     ДЕМОС/PV


MKMF(1)                ДЕМОС. Команды                MKMF(1)


                     библиотеки  и  размещение  их  в том же
                     каталоге, в котором находятся и  исход-
                     ные файлы. Время модификации библиотеки
                     не изменяется.

       iinnddeexx         Печать индекса функций в файл стандарт-
                     ного вывода.

       iinnssttaallll       Трансляция,  загрузка  программы   (или
                     библиотеки)  и  установка ее в каталоге
                     назначения.

       lliibbrraarryy       Трансляция и загрузка библиотеки.

       pprriinntt         Печать исходных файлов в файл стандарт-
                     ного вывода.

       ttaaggss          Создание  файла  ссылок  для  программ,
                     написанных  на  языках  Си,  Паскаль  и
                     Фортран.

       pprrooggrraamm       Трансляция и загрузка программы.

       uuppddaattee        Перетрансляция только тех исходных фай-
                     лов, которые были модифицированы позже,
                     чем сама  программа  (или  библиотека);
                     загрузка  и  установка  программы  (или
                     библиотеки)  в   каталоге   назначения.
                     Если  время  модификации  библиотеки не
                     менялось,  то   перед   перетрансляцией
                     необходимо   удалить  старые  объектные
                     файлы.

       Можно задать несколько функций  одновременно.  Напри-
       мер, в результате выполнения команды:

              mmaakkee pprrooggrraamm iinnssttaallll cclleeaann

       будут выполнены трансляция, загрузка программы, уста-
       новка ее в каталоге назначения и удалены все ненужные
       больше объектные файлы.

       ММааккррооппееррееммеенннныыее

       mmkkmmff определяет значения следующих макропеременных:

       CCFFLLAAGGSS    Ключи Си-компилятора. При  поиске  _i_n_c_l_u_d_e-
                 файлов  mmkkmmff  последовательно просматривает
                 текущий каталог, каталоги, указываемые клю-
                 чом --II и каталог /_u_s_r/_i_n_c_l_u_d_e.

       DDEESSTT      Каталог, в  котором  устанавливается  прог-
                 рамма или библиотека (каталог назначения).

       EEXXTTHHDDRRSS   Перечень полных имен _i_n_c_l_u_d_e-файлов относи-
                 тельно  текущего  каталога.   При генерации
                 графов  зависимостей   mmkkmmff   автоматически
                 модифицирует  в  _m_a_k_e-файле  значение  этой


                            -2-                     ДЕМОС/PV


MKMF(1)                ДЕМОС. Команды                MKMF(1)


                 макропеременной.

       FFFFLLAAGGSS    Ключи  Фортран-компилятора.  После   поиска
                 _i_n_c_l_u_d_e-файлов   в  текущем  каталоге  mmkkmmff
                 просматривает  каталоги,  указанные  ключом
                 --II.

       HHDDRRSS      Список _i_n_c_l_u_d_e-файлов, находящихся в  теку-
                 щем  каталоге; mmkkmmff автоматически модифици-
                 рует в _m_a_k_e-файле значение этой  макропере-
                 менной.

       LLIIBBRRAARRYY   Задает имя  библиотеки.  С  этой  же  целью
                 можно использовать ключ --ll.

       LLIIBBSS      Список  библиотек,  необходимых   редактору
                 связи для внешних ссылок.

       MMAAKKEEFFIILLEE  Имя _m_a_k_e-файла.

       OOBBJJSS      Список объектных файлов; mmkkmmff автоматически
                 модифицирует  в  _m_a_k_e-файле  значение  этой
                 макропеременной.

       PPRROOGGRRAAMM   Имя программы.

       SSRRCCSS      Список всех исходных файлов; mmkkmmff автомати-
                 чески модифицирует значение этой макропере-
                 менной.

       SSUUFFFFIIXX    Задает список нестандартных суффиксов  имен
                 файлов.

       Значения как  этих,  так  и  других  макропеременных,
       содержащихся  в _m_a_k_e-файле, могут быть изменены аргу-
       ментом mmkkmmff вида  _м_а_к_р_о_и_м_я=_з_н_а_ч_е_н_и_е.   Например,  для
       того   чтобы   поменять   в   _m_a_k_e-файле   ключи  Си-
       компилятора,  имя  программы  и  каталог  назначения,
       пользователь должен набрать командную строку вида:

       mmkkmmff ""CCFFLLAAGGSS=--II../_i_n_c_l_u_d_e --OO"" PPRROOGGRRAAMM=_m_k_m_f \\
            DDEESSTT=/_u_s_r/_n_e_w

       ООббррааттииттее ввннииммааннииее ннаа ттоо,, ччттоо еессллии вв ззннааччееннииии ммааккррооппее--
       ррееммеенннныыхх ттииппаа CCFFLLAAGGSS имеются пробелы, то такие макро-
       переменные нужно заключать в двойные кавычки ""..."".

       ССууффффииккссыы ииммеенн ффааййллоовв

       При работе с mmkkmmff можно дополнительно определять нес-
       тандартные и отменять значения ранее заданных суффик-
       сов имен файлов.  Новые суффиксы описываются макропе-
       ременной  SSUUFFFFIIXX.   Описание  каждого  суффикса имеет
       формат:

              ._с_у_ф_ф_и_к_с:_t_I




                            -3-                     ДЕМОС/PV


MKMF(1)                ДЕМОС. Команды                MKMF(1)


       где _t - это символ указывающий тип файла (ss -  исход-
       ный,  oo  -  объектный, hh - _i_n_c_l_u_d_e-файл, xx - выполни-
       мый), а _I - произвольный символ, определяющий синтак-
       сис  обращения  к _i_n_c_l_u_d_e-файлам (CC - синтаксис языка
       Си, FF - Фортран, Efl и Ратфор, PP - Паскаль).  В  mmkkmmff
       по  умолчанию используется следующая стандартная кон-
       фигурация суффиксов:

       ._c:ssCC   Си
       ._e:ssFF   Efl
       ._F:ssFF   Фортран
       ._f:ssFF   Фортран
       ._h:hh    _I_n_c_l_u_d_e-файлы языка Си
       ._i:hh    _I_n_c_l_u_d_e-файлы языка Паскаль
       ._l:ss    Lex или Lisp
       ._o:oo    Объектные файлы
       ._p:ssPP   Паскаль
       ._r:ssFF   Ратфор
       ._s:ss    Ассемблер
       ._y:ss    Yacc

       Например, для того, чтобы заменить  стандартный  суф-
       фикс  объектного  файла  ._o на ._o_b_j, отменить суффикс
       _i_n_c_l_u_d_e-файла языка Паскаль и поиск _i_n_c_l_u_d_e-файлов  в
       исходных  файлах,  написанных на Фортране, макропере-
       менной SSUUFFFFIIXX нужно присвоить следующее значение:

       SSUUFFFFIIXX = ._o_b_j:oo  ._i:  ._f:ss

       ФФааййллыы--шшааббллоонныы

       Если в текущем каталоге _m_a_k_e-файл отсутствует, то для
       его  сборки  программа  mmkkmmff  обычно  использует либо
       стандартные файлы-шаблоны _p._M_a_k_e_f_i_l_e или  _l._M_a_k_e_f_i_l_e,
       находящиеся  в каталоге /_u_s_r/_n_e_w/_l_i_b, либо определен-
       ные   пользователем   альтернативные    файлы-шаблоны
       _p._M_a_k_e_f_i_l_e или _l._M_a_k_e_f_i_l_e из каталога _п_р_о_е_к_т/_l_i_b, где
       _п_р_о_е_к_т - абсолютное имя каталога,  являющееся  значе-
       нием макропеременной PPRROOJJEECCTT.

ККЛЛЮЮЧЧИИ
       --cc  Подавляет сообщение "creating _m_a_k_e_f_i_l_e from ...".

       --dd  Отменяет поиск _i_n_c_l_u_d_e-файлов в исходных  файлах.
           Графы зависимостей не модифицируются.

       --ff _m_a_k_e-файл
           Задает альтернативное имя _m_a_k_e-файла. По  умолча-
           нию - _M_a_k_e_f_i_l_e.

       --ii  Задает интерактивный режим работы mmkkmmff: у пользо-
           вателя  спрашивается  имя  программы (или библио-
           теки) и каталог, в котором она должна быть  уста-
           новлена.  Если в ответ на каждый из этих вопросов
           была нажата клавиша ВВКК, то по умолчанию имя прог-
           раммы  будет  _a._o_u_t,  имя  библиотеки  - _l_i_b._a, а
           каталогом назначения - текущий каталог.



                            -4-                     ДЕМОС/PV


MKMF(1)                ДЕМОС. Команды                MKMF(1)


       --ll  Указывает на то, что _m_a_k_e-файл  предназначен  для
           сборки библиотеки.

       --FF _ш_а_б_л_о_н
           Задает альтернативный файл-шаблон.  По  умолчанию
           файлом-шаблоном для программ является _p._M_a_k_e_f_i_l_e,
           а  для  библиотек  -  _l._M_a_k_e_f_i_l_e.   Обычно   mmkkmmff
           использует файлы-шаблоны, расположенные в катало-
           гах /_u_s_r/_n_e_w/_l_i_b или  _п_р_о_е_к_т/_l_i_b.   Однако  файл-
           шаблон  может  быть  задан  и  в виде абсолютного
           имени.

ФФААЙЙЛЛЫЫ
       /_u_s_r/_n_e_w/_l_i_b/_p._M_a_k_e_f_i_l_e  файл-шаблон для программ
       /_u_s_r/_n_e_w/_l_i_b/_l._M_a_k_e_f_i_l_e  файл-шаблон для библиотек
       _п_р_о_е_к_т/_l_i_b/_p._M_a_k_e_f_i_l_e    файл-шаблон пользователя для
                                программ
       _п_р_о_е_к_т/_l_i_b/_l._M_a_k_e_f_i_l_e    файл-шаблон пользователя для
                                библиотек

ДДООППООЛЛННИИТТЕЕЛЛЬЬННЫЫЕЕ ССССЫЫЛЛККИИ
       _a_r(1), _c_t_a_g_s(1), _l_d(1), _l_s(1), _m_a_k_e(1)

       См. также отдельное описание mmaakkee.

ДДИИААГГННООССТТИИККАА
       При успешном выполнении команды код завершения  равен
       0, при наличии ошибки - 1.

ЗЗААММЕЕЧЧААННИИЯЯ
       Имя _m_a_k_e-файла задается в _m_a_k_e-файле  макропеременной
       MMAAKKEEFFIILLEE, поэтому при переименовании _m_a_k_e-файла нужно
       изменить и значение этой макропеременной.

       Поскольку выполняемые файлы зависят от библиотек,  то
       названия стандартных библиотек в макропеременной LLIIBBSS
       _m_a_k_e-файла должны быть расширены до их полных имен.

       Генерируемая информация о зависимостях вставляется  в
       _m_a_k_e-файл  после  строки, начинающейся символами ######.
       Нельзя удалять эту  строку.  Нельзя  вставлять  после
       этой строки другую информацию.


















                            -5-                     ДЕМОС/PV

