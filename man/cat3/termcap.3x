
TERMCAP(3X)     ДЕМОС. Библиотечные функции      TERMCAP(3X)


ИИММЯЯ
       ttggeetteenntt, ttggeettnnuumm, ttggeettffllaagg, ttggeettssttrr, ttggoottoo,  ttppuuttss  -
       независимые от терминалов программы обслуживания

ФФООРРММААТТ
       cchhaarr  PPCC;
       cchhaarr *BBCC;
       cchhaarr *UUPP;
       sshhoorrtt oossppeeeedd;

       ttggeetteenntt(_b_p, _n_a_m_e)
       cchhaarr *_b_p, *_n_a_m_e;

       ttggeettnnuumm(_i_d)
       cchhaarr *_i_d;

       ttggeettffllaagg(_i_d)
       cchhaarr *_i_d;

       cchhaarr *
       ttggeettssttrr(_i_d, _a_r_e_a)
       cchhaarr *_i_d, **_a_r_e_a;

       cchhaarr *
       ttggoottoo(_c_m, _d_e_s_t_c_o_l, _d_e_s_t_l_i_n_e)
       cchhaarr *_c_m;

       ttppuuttss(_c_p, _a_f_f_c_n_t, _o_u_t_c)
       rreeggiisstteerr cchhaarr *_c_p;
       iinntt _a_f_f_c_n_t;
       iinntt (*_o_u_t_c)();

       cccc ... --lltteerrmmccaapp

ООППИИССААННИИЕЕ
       Эти функции определяют и используют возможности  тер-
       миналов на основе информации, находящейся в базе дан-
       ных с описаниями терминалов /_e_t_c/_t_e_r_m_c_a_p.

       Функция ttggeetteenntt помещает запись о  терминале  _n_a_m_e  в
       буфер,  начинающийся с _b_p.  Буфер _b_p должен быть сим-
       вольным массивом размером 1024 байт, и должен  сохра-
       няться  для  всех  последующих  обращений  к ttggeettnnuumm,
       ttggeettffllaagg и ttggeettssttrr.  Функция ttggeetteenntt возвращает  одно
       из следующих значений:

       -1  - если не может открыть файл _t_e_r_m_c_a_p;
        0  - если терминал с указанным именем не доступен;
        1  - если работа выполнена успешно.

       Эта функция ищет в среде процесса переменную TTEERRMMCCAAPP.
       Если эта переменная найдена, содержимое не начинается
       с `/' и имя типа терминала  такое  же,  как  значение
       макропеременной  среды  TTEERRMM,  файл  /_e_t_c/_t_e_r_m_c_a_p  не
       читается, а вместо этого используется строка TTEERRMMCCAAPP.
       Если  строка  начинается  с `/', она используется как
       полное имя  файла  с  описаниями  терминалов  (вместо
       /_e_t_c/_t_e_r_m_c_a_p).   Так можно ускорить вход в программы,


                            -1-                     ДЕМОС/PV


TERMCAP(3X)     ДЕМОС. Библиотечные функции      TERMCAP(3X)


       использующие ttggeetteenntt, а также упростить отладку новых
       описаний  терминалов  или создать описание для вашего
       терминала,  если  вы  не  можете  записывать  в  файл
       /_e_t_c/_t_e_r_m_c_a_p.  В этом случае или в случае, если пере-
       менная TTEERRMMCCAAPP вообще не  установлена,  ttggeetteenntt  ищет
       описание  терминала  с  именем  из  переменной TTEERRMM в
       файле с описаниями терминалов.

       Функция ttggeettnnuumm получает числовое значение  описателя
       _i_d,  возвращая  -1, если такой описатель не задан для
       вашего терминала.

       Функция ttggeettffllaagg возвращает 1, если указанный  описа-
       тель  _i_d  присутствует в записи о терминале и 0, если
       отсутствует.

       Функция ttggeettssttrr получает значение строки  о  свойстве
       _i_d,  размещая ее в буфере, на который указывает пере-
       менная, находящаяся по адресу _a_r_e_a.  Эта функция рас-
       шифровывает  аббревиатуры для этого поля, описанные в
       _t_e_r_m_c_a_p(5), за исключением специальных последователь-
       ностей  адресации  курсора  и информации о задержках.
       Побочным эффектом работы ttggeettssttrr является  увеличение
       значения  адреса буфера в переменной, на которую ука-
       зывает _a_r_e_a, на величину, равную числу байтов в  выб-
       ранной строке описания.

       Функция ttggoottoo возвращает  строку  адресации  курсора,
       расшифровываемую из строки _c_m, для перевода курсора в
       колонку _d_e_s_t_c_o_l в строке _d_e_s_t_l_i_n_e.   Функция  исполь-
       зует внешние переменные UUPP (строка из описателя _u_p) и
       BBCC (если задано _b_c, а не _b_s) в случае, когда  необхо-
       димо  избежать размещения символов `\\tt', `\\nn', CCTTRRLL//DD
       или _п_у_с_т_о (\0) в возвращаемой  строке.   Если  задана
       специальная   последовательность   адресации  курсора
       `%...', которая не понятна  функции  (см.  допустимые
       последовательности  в  _t_e_r_m_c_a_p(5)),  ttggoottoo возвращает
       строку "_O_O_P_S".  Строку адресации ttggoottoo строит в  ста-
       тической области, поэтому при новом вызове ttggoottoo ста-
       рая строка адресации затирается.

       Функция ttppuuttss расшифровывает информацию  о  задержках
       из  строки _c_p; с помощью _a_f_f_c_n_t задается число строк,
       на которые переместится курсор в результате  выполне-
       ния этой операции, или 1, если это количество не вли-
       яет на величину задержки.  (_a_f_f_c_n_t просто  умножается
       на величину задержки).  _o_u_t_c представляет собой прог-
       рамму, которая вызывается для каждого очередного сим-
       вола. Внешняя переменная oossppeeeedd должна содержать ско-
       рость вывода терминала в условных единицах  от  0  до
       15, см.  _t_t_y(4).  Внешняя переменная PPCC должна содер-
       жать заполняющий символ, который будет использоваться
       (из  описателя  _p_c), если нулевой символ непригоден в
       качестве заполнителя.

       Таким образом, процедура ttppuuttss должна  использоваться
       для  вывода  строк,  полученных  при помощи ttggeettssttrr и
       ttggoottoo.


                            -2-                     ДЕМОС/PV


TERMCAP(3X)     ДЕМОС. Библиотечные функции      TERMCAP(3X)


ФФААЙЙЛЛЫЫ
       /_u_s_r/_l_i_b/_l_i_b_t_e_r_m_c_a_p._a  библиотека --lltteerrmmccaapp
       /_e_t_c/_t_e_r_m_c_a_p           база данных по терминалам

ДДООППООЛЛННИИТТЕЕЛЛЬЬННЫЫЕЕ ССССЫЫЛЛККИИ
       _t_e_r_m_c_a_p(5), _t_t_y(4), _c_u_r_s_e_s(3x), _r_e_d(1)

ЗЗААММЕЕЧЧААННИИЯЯ
       Полезно было бы задавать имя файла - базы  данных  во
       внешней  переменной.   Это  позволило бы использовать
       библиотеку --lltteerrmmccaapp  для  аналогичных  применений  в
       других областях.
















































                            -3-                     ДЕМОС/PV

