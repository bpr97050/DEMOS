
RESTOR(8)       ДЕМОС. Сопровождение системы       RESTOR(8)


ИИММЯЯ
        rreessttoorr, 551122rreessttoorr - восстановление файловой системы.

ФФООРРММААТТ
        rreessttoorr _к_л_ю_ч_и [_а_р_г_у_м_е_н_т...]
        551122rreessttoorr _к_л_ю_ч_и [_а_р_г_у_м_е_н_т...]

ООППИИССААННИИЕЕ
        Команда rreessttoorr восстанавливает файловую систему с ее
        копии, полученной с помощью команды _d_u_m_p(8).  Первый
        параметр _к_л_ю_ч_и определяет  режим  работы  команды  и
        составляется из следующих ключей:

        ff    Следующий  аргумент  используется  в   качестве
             имени  файла,  содержащего  копию файловой сис-
             темы.

        FF    Следующий  аргумент  используется  в   качестве
             номера файла на ленте.  При этом перед командой
             rreessttoorr  не  требуется  перематывать  ленту   на
             начало нужного файла; это сделает сама команда.
             Также не требуется "вручную"  отматывать  ленту
             назад  после  того,  как  файл найден в списке.
             Номера файлов на ленте отсчитываются от 1.

        rr, RR Последний аргумент задает имя файловой системы,
             в которую помещается считанная с ленты информа-
             ция.  Если используется ключ RR, команда  rreessttoorr
             запрашивает, какую ленту из многотомного набора
             обрабатывать,  это  позволяет   восстанавливать
             файловую систему по частям.  Если указана лента
             номер 0, блокируется проверка на номер ленты  и
             на  правильность  заголовка тома, что позволяет
             читать ленты с копиями с середины или с  испор-
             чены началом.  В всех случаях, если работа rreess--
             ttoorr закончилась аварийно или прочитаны  не  все
             ленты  с  копиями,  необходимо вызывать команду
             iicchheecckk --ss для восстановления  списка  свободных
             блоков.

        xx    Все аргументы команды (после аргументов  ключей
             ff и FF, если эти ключи есть) рассматриваются как
             имена файлов, которые необходимо восстановить с
             копии  на ленте. Эти файлы помещаются в указан-
             ную файловую систему  под  "вымышленными"  име-
             нами,  составленными  из  их  I-номеров.   Если
             образ файловой системы занимает несколько лент,
             рекомендуется следующая процедура:

             Поставьте первую ленту из  набора  и  запустите
             команду  rreessttoorr,  которая  должна выдать список
             найденных файлов и их  I-номеров.  После  этого
             лента перематывается и выдается сообщение:

                     _M_o_u_n_t _t_h_e _d_e_s_i_r_e_d _t_a_p_e _v_o_l_u_m_e
                     (_У_с_т_а_н_о_в_и_т_е _н_у_ж_н_у_ю _л_е_н_т_у)

             Введите  номер  нужного  тома.  Команда  rreessttoorr


                            -1-                      ДЕМОС/P


RESTOR(8)       ДЕМОС. Сопровождение системы       RESTOR(8)


             проверит  наличие требуемых файлов на подмонти-
             рованном томе (или на следующей ленте, в обрат-
             ном  порядке)  и  не  будет  читать ленту, если
             файлы не найдены.  При работе с копией на одной
             ленте или если требуется восстановить несколько
             очень больших файлов, запустите запрос с  ленты
             1  и rreessttoorr будет читать ленты в последователь-
             ном порядке.

             Если вы хотите сохранить иерархию  при  восста-
             новлении,  вы можете использовать команду _d_u_m_p_-
             _d_i_r(8) для получения списка имен для  пересылки
             найденных файлов в требуемые каталоги.

        tt    Выдается дата записи  ленты  и  дата  получения
             копии данной файловой системы.

        Ключи xx, rr, RR и tt взаимоисключающие.

        Ключ rr используется только для полного  восстановле-
        ния, начиная с пустой файловой системы, например:

                //eettcc//mmkkffss /_d_e_v/_r_p_0_a 4807
                    (установлена лента с дампом уровня 0)
                rreessttoorr rr /_d_e_v/_r_p_0_a
                    (установлена лента с дампом уровня 1)
                rreessttoorr rr /_d_e_v/_r_p_0_a
                    (и т.д.)

        Следует отметить, что команда rreessttoorr может использо-
        ваться  и  для  модификации размера файловой системы
        следующим образом:

                //eettcc//dduummpp 00uu /_d_e_v/_r_p_0_a
                //eettcc//mmkkffss /_d_e_v/_r_p_0_a 3000
                rreessttoorr rr /_d_e_v/_r_p_0_a

        Команда 551122rreessttoorr предназначена для работы с копиями
        файловых систем ранних версий ДЕМОС (до 1.3).

ФФААЙЙЛЛЫЫ
        /_d_e_v/_n_r_m_t_1  имя ленты по умолчанию
        _r_s_t*        временные файлы

ДДООППООЛЛННИИТТЕЕЛЛЬЬННЫЫЕЕ ССССЫЫЛЛККИИ
        _d_u_m_p(8), _d_u_m_p_d_i_r(8), _m_k_f_s(8)

ДДИИААГГННООССТТИИККАА
        Выдаются сообщения об ошибках ввода/вывода и несоот-
        ветствиях  в параметрах указанной файловой системы и
        копии на ленте.

        Если образ файловой системы занимает несколько носи-
        телей,  команда  rreessttoorr  требует установку очередной
        ленты.  После смены ленты необходимо нажать  клавишу
        ВК.




                            -2-                      ДЕМОС/P


RESTOR(8)       ДЕМОС. Сопровождение системы       RESTOR(8)


ЗЗААММЕЕЧЧААННИИЯЯ
        Все ключи команды rreessttoorr задаются без пробелов.  При
        одновременном  использовании  ключей  ff и FF их аргу-
        менты должны следовать в том же порядке, в  каком  и
        соответствующие ключи:

        rreessttoorr rrffFF /_d_e_v/_n_r_m_t_1 3 /_d_e_v/_r_k_2

        Здесь /_d_e_v/_n_r_m_t_1 - аргумент ключа ff;  3  -  аргумент
        ключа FF.

        Положение ключей xx и rr (RR)  в  "ключевом  слове"  не
        существенно;  в  приведенном выше примере можно было
        написать rreessttoorr ffrrFF или rreessttoorr ffFFrr, при этом порядок
        аргументов  не меняется: аргументы ключей xx, rr или RR
        в любом случае  должны  следовать  после  аргументов
        ключей ff и FF.











































                            -3-                      ДЕМОС/P

