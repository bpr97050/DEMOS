
MSGSND(2)         ДЕМОС. Системные вызовы          MSGSND(2)


ИИММЯЯ
       mmssggssnndd,, mmssggrrccvv - посылка и прием сообщений.

ФФООРРММААТТ
       #iinncclluuddee <_s_y_s/_t_y_p_e_s._h>
       #iinncclluuddee <_s_y_s/_i_p_c._h>
       #iinncclluuddee <_s_y_s/_m_s_g._h>

       mmssggssnndd( _i_d, _m_s_g_p, _s_i_z_e, _f_l_a_g )
       iinntt _i_d, _s_i_z_e, _f_l_a_g;
       ssttrruucctt mmssggbbuuff *_m_s_g_p;

       mmssggrrccvv( _i_d, _m_s_g_p, _s_i_z_e, _t_y_p_e, _f_l_a_g )
       iinntt _i_d, _s_i_z_e, _f_l_a_g;
       lloonngg _t_y_p_e;
       ssttrruucctt mmssggbbuuff *_m_s_g_p;

ООППИИССААННИИЕЕ
       Системный вызов  mmssggssnndd  посылает  сообщение  размера
       _s_i_z_e байт, содержащееся в буфере _m_s_g_p в очередь сооб-
       щений с идентификатором  _i_d.  Сообщение  представлено
       структурой  ssttrruucctt mmssggbbuuff, которая определена следую-
       щим образом:

       ssttrruucctt mmssggbbuuff {
            lloonngg mmttyyppee;    /* тип сообщения (число > 0) */
            cchhaarr mmtteexxtt[];  /* текст сообщения */
       };

       _s_i_z_e, указываемое  в  аргументах  системного  вызова,
       обозначает  количество  байт  в  поле _m_t_e_x_t структуры
       _m_s_g_p.

       Если не указан флаг IIPPCC__NNOOWWAAIITT и число байт в очереди
       превосходит  максимальное  допустимое для данной оче-
       реди значение или число сообщений  в  очереди  больше
       допустимого  (смотри  mmssggccttll((22))),  то  mmssggssnndd ожидает
       освобождения ресурсов, и только дождавшись  добавляет
       сообщение в очередь.  Если же флаг IIPPCC__NNOOWWAAIITT указан,
       то при невозможности послать сообщение mmssggssnndd возвра-
       щает ошибку EEAAGGAAIINN.

       Если указан флаг MMSSGG__OOOOBB, то сообщение добавляется не
       в конец, а в начало очереди.

       mmssggrrccvv принимает сообщение из очереди  _i_d,  записывая
       его в структуру, указываемую аргументом _m_s_g_p. Сообще-
       ние из очереди изымается.

       _t_y_p_e указывает тип  сообщения,  которое  должно  быть
       принято. Если

       _t_y_p_e == 0l
              то принимается первое сообщение любого типа.

       _t_y_p_e > 0
              то  принимается  первое  сообщение  указанного
              типа.


                            -1-                      ДЕМОС/P


MSGSND(2)         ДЕМОС. Системные вызовы          MSGSND(2)


       _t_y_p_e < 0
              Принимается  первое  сообщение  с   наименьшим
              типом, который <= -_t_y_p_e

       Если сообщения подходящего  типа  нет,  то  системный
       вызов  дожидается  его получения. Если же указан флаг
       IIPPCC__NNOOWWAAIITT, то вызов не дожидается, а возвращает  код
       ошибки EENNOOMMSSGG.

       Если указан флаг IIPPCC__EEXXCCLL и значение  _t_y_p_e  >  0,  то
       принимается первое сообщение типа, не равного _t_y_p_e.

       _s_i_z_e указывает максимальный размер текста  сообщения.
       Если размер очередного сообщения нужного типа превос-
       ходит эту величину, системный  вызов  возвращает  код
       ошибки  EE22BBIIGG.  Если  же  указан флаг MMSSGG__NNOOEERRRROORR, то
       сообщение обрезается до длины _s_i_z_e и принимается.

       mmssggrrccvv возвращает размер в  байтах  текста  принятого
       сообщения.

ККООДДЫЫ ООШШИИББООКК
       При ошибке системные вызовы возвращают значение -1  и
       код ошибки в переменной eerrrrnnoo.

       [[EENNOOEENNTT]]    Очередь с идентификатором _i_d  не  сущест-
                   вует.

       [[EEAACCCCEESS]]    Не имеете права чтения или записи в  оче-
                   редь.

       [[EEFFAAUULLTT]]    В качестве аргумента указан адрес,  лежа-
                   щий вне адресного простанства процесса.

       [[EEIINNVVAALL]]    Величина _s_i_z_e < 0, либо при посылке сооб-
                   щения указан mmttyyppee < 1l.

       [[EEFFBBIIGG]]     Попытка послать слишком  большое  сообще-
                   ние.

       [[EEIIDDRRMM]]     Во время ожидания очередь сообщений  была
                   удалена вызовом mmssggccttll.

       [[EEIINNTTRR]]     Ожидание прервано сигналом.

       [[EEAAGGAAIINN]]    У mmssggssnndd указан  флаг  IIPPCC__NNOOWWAAIITT  и  нет
                   ресурсов  для размещения сообщения в оче-
                   реди.

       [[EE22BBIIGG]]     Получено сообщение, превосходящее  разме-
                   ром _s_i_z_e.

       [[EENNOOMMSSGG]]    У mmssggrrccvv указан флаг IIPPCC__NNOOWWAAIITT и в  оче-
                   реди нет сообщений требуемого типа.

ДДООППООЛЛННИИТТЕЕЛЛЬЬННЫЫЕЕ ССССЫЫЛЛККИИ
       _m_s_g_g_e_t(2), _m_s_g_c_t_l(2).



                            -2-                      ДЕМОС/P

